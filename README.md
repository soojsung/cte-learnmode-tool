# CTE Tool

CTE Tool is a PowerShell utility for analysing CipherTrust Transparent Encryption (CTE) agent logs on Windows and providing detailed information about users and processes that have accessed guarded resources. The tool specifically focuses on LEARN MODE logs, helping administrators determine access patterns before applying enforcement policies.

## Overview

This tool helps security administrators analyse access to resources protected by CTE. It parses log files generated by the agent and organizes access information by guardpoint folders, showing:

- Which users accessed each guardpoint
- What processes were used 
- Which specific resources were accessed
- What types of actions were performed (reading, writing, etc.)

## Features

- Automatic processing of all CTE agent log files in a directory
- Guardpoint-centric organization for easier policy development
- Comprehensive breakdown of user, process, and resource access
- Classification of access actions (reading, writing, creating, etc.)
- Support for multiple log files with aggregated results

## Requirements

- Windows operating system
- PowerShell 5.0 or newer
- Access to CTE agent log files with LEARN MODE entries

## Usage

### Basic Usage

Run the script without parameters to process the default log directory:

```powershell
.\cte-tool.ps1
```

This will analyse all matching log files (`vorvmd*.log*`) in the default directory `C:\ProgramData\Vormetric\DataSecurityExpert\agent\log`.

### Specifying a Custom Log Directory

To analyse logs in a different directory:

```powershell
.\cte-tool.ps1 -logpath "C:\path\to\log\directory"
```

> **Note:** The `-logpath` parameter must specify a directory containing log files, not a specific file.

## Output Format

The tool organizes output by detected guardpoint folders:

### Guardpoint Information

For each guardpoint, the tool displays:

```
=== GUARDPOINT: C:\Temp2 (92 accesses) ===
  Statistics:
    - Users: 3
    - Processes: 4
    - Resources: 4
    - Access Events: 92

  Users:
    - Administrator\ (7 accesses)
    - Administrator\LAB (6 accesses)
    - SYSTEM\NT AUTHORITY (4 accesses)

  Processes:
    - explorer.exe (9 accesses)
      Path: C:\Windows\explorer.exe
    - notepad.exe (4 accesses)
    [Additional processes...]

  Resources:
    - C:\Temp2\ (8 accesses)
      Common action: listing
    - C:\Temp2\Test.txt (7 accesses)
      Common action: reading
    [Additional resources...]
```

### Summary

The tool provides an overall summary of activity:

```
=== SUMMARY ===
  Total Users: 6
  Total Processes: 8
  Total Resources: 23
  Detected GuardPoints: 5
  Total Access Events: 2650
```

## How It Works

1. The tool finds all CTE log files in the specified directory
2. It extracts information from LEARN MODE log entries only
3. The script identifies guardpoint folders from resource paths
4. Access information is grouped by guardpoint 
5. Results are displayed in a structured, readable format

## Troubleshooting

### Log Files Not Found

If no log files are found, verify you're pointing to the correct directory containing `vorvmd*.log*` files.

### No Data Displayed

If the tool runs but shows no data, verify:
- The log files contain CTE agent logs
- There are LEARN MODE entries in the logs
- The files are readable by your user account

## Credits

This tool is based on modules from the Thales CipherTrust Transparent Encryption GitHub repository:
https://github.com/thalescpl-io/CipherTrust_Transparent_Encryption/tree/main/tools/learn-mode-policy-builder

## Version

1.0 
